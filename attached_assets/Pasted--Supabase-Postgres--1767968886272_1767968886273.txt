نحن الآن ننتقل من مرحلة التصميم إلى مرحلة قاعدة البيانات باستخدام Supabase (Postgres).
أريد منك أولاً أن تلخص كيف يعمل البرنامج (Workflow + الكيانات الأساسية) ثم تكتب SQL لإنشاء الجداول.

⚠️ مهم:
- لا تغيّر تصميم الواجهات الآن.
- لا تكتب كود Backend.
- فقط: شرح مختصر + SQL.

────────────────────────────
1) وصف البرنامج (ملخص تشغيلي)
────────────────────────────
البرنامج لإدارة شراكة بين شخصين على مشروعين فقط.
التدفق:
- المستخدم يسجل دخول
- يختار مشروع (Project 1 أو Project 2) مرة واحدة
- يعمل على صفحات:
  المعاملات / الفترات / التقارير / الإشعارات / سجل الأحداث / المستخدمين

قواعد محاسبية أساسية:
- كل معاملة مرتبطة بـ Project + Period.
- الفترة لها حالة: مفتوحة / مغلقة.
- إذا الفترة مغلقة: يمنع تعديل/حذف/إضافة معاملات عليها.
- يوجد تقرير كشف حساب الشركاء لكل فترة (حصة الشركاء 50%).
- صفحة الإشعارات: لكل عملية إشعار يمكن إرساله Email + WhatsApp وتسجيل حالته.
- سجل الأحداث: يسجل أي حدث مهم (فتح/إغلاق فترة، إنشاء/تعديل/حذف معاملة، إرسال إشعار، فشل إرسال، منع عملية، إلخ).

المستخدمين:
- مستخدمين فقط:
  - ADMIN (كل الصفحات)
  - TX_ONLY (المعاملات فقط)
- بيانات المستخدم للعرض: الاسم، الإيميل، الجوال، الدور.
- كلمات المرور وإدارة الدخول ستكون لاحقاً عبر Supabase Auth (لا ننشئ جدول كلمات مرور).

────────────────────────────
2) المطلوب: تصميم قاعدة البيانات (Supabase Postgres)
────────────────────────────
أريد جداول بهذه الفكرة (اقترح أسماء مناسبة وحقول مناسبة):

A) projects
- مشروعين

B) periods
- period_id, project_id
- name (مثل يناير 2025)
- status (ACTIVE/CLOSED)
- opened_at, closed_at
- ملاحظة: نريد لاحقاً الرصيد الافتتاحي والختامي لكل شريك داخل الفترة

C) users_profile (اختياري إذا احتجناه)
- user_id (uuid من auth.users)
- name, email, phone, role (ADMIN/TX_ONLY)
- ملاحظة: لا نخزن password هنا

D) transactions
- transaction_id
- project_id, period_id
- type (INCOME/EXPENSE/SETTLEMENT)
- date
- description
- amount
- paid_by / received_by أو from_partner/to_partner (حسب النوع)
- created_by, created_at

E) notifications
- notification_id
- transaction_id
- status (PENDING/SENT/FAILED)
- last_error
- sent_email_at, sent_whatsapp_at
- created_at

F) event_logs
- event_id
- project_id, period_id (اختياري)
- transaction_id (اختياري)
- user_id (اختياري)
- event_type (TX_CREATED, PERIOD_OPENED, NOTIF_FAILED...)
- message
- created_at

G) period_partner_balances (لتثبيت الأرصدة عند فتح/إغلاق الفترة)
- id
- project_id, period_id
- partner (PARTNER1/PARTNER2) أو partner_user_id
- opening_balance
- closing_balance

ملاحظة: الشريكين 2 فقط، لكن صممها بشكل لا يتعبنا.

────────────────────────────
3) بعد تحديد التصميم: أعطني SQL كامل
────────────────────────────
اكتب SQL جاهز لسوبابيس:
- CREATE TABLE لكل الجداول
- مفاتيح أساسية PK
- علاقات FK + ON DELETE/UPDATE منطقي
- قيود CHECK للأنواع (type/status)
- فهارس indexes للأشياء المهمة
- timestamps default now()

وأعطني في النهاية ملاحظات قصيرة:
- أين أضع RLS لاحقاً؟
- وأي قيود تقترحها لمنع معاملات على فترة مغلقة (حتى لو هذا سيطبق لاحقاً بالـ triggers).